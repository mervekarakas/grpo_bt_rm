# -------- dataset + output --------
export DATASET="${DATASET:-/data/$USER/datasets/grpo_bt_train_score100_v1.jsonl}"

# Put run-id in the OUT_DIR so it matches your old-school layout
export RUN_ID="${RUN_ID:-hardmine_T20C10_tau0.25_lam1.0_eps0.5}"
export OUT_DIR="${OUT_DIR:-/data/$USER/experiments/grpo_bt_rm/expA_score100_T20_C10_posclip_hardmine/${RUN_ID}}"

# -------- swift plugin wiring --------
export PLUGIN="${PLUGIN:-src/grpo_bt_rm/training/reward_plugins/bt_baseline_hardmine.py}"
export REWARD_NAME="${REWARD_NAME:-bt_pointwise_baseline_hardmine}"

# -------- reward parsing + scaling --------
export BT_SCORE_PARSER="${BT_SCORE_PARSER:-score100_first}"
export BT_DELTA_TEMP="${BT_DELTA_TEMP:-20}"
export BT_DELTA_CLIP="${BT_DELTA_CLIP:-10}"
export BT_DELTA_NEG_CLIP="${BT_DELTA_NEG_CLIP:-0}"   # 0 => pos-only
export BT_REWARD_SCALE="${BT_REWARD_SCALE:-1}"

# -------- hard-mining knobs --------
# tau is in scaled units: (delta_mean_pref / BT_DELTA_TEMP)
export BT_HARD_TAU="${BT_HARD_TAU:-0.25}"
export BT_HARD_LAMBDA="${BT_HARD_LAMBDA:-1.0}"
export BT_HARD_EPS="${BT_HARD_EPS:-0.5}"

# -------- training knobs (optional: keep same defaults, but explicit is safer) --------
export MAX_STEPS="${MAX_STEPS:-8000}"
export SAVE_STEPS="${SAVE_STEPS:-500}"
export LOGGING_STEPS="${LOGGING_STEPS:-20}"
export LEARNING_RATE="${LEARNING_RATE:-5e-6}"

# -------- wandb --------
export WANDB_PROJECT="${WANDB_PROJECT:-grpo_bt_rm}"
export WANDB_RUN_NAME="${WANDB_RUN_NAME:-$RUN_ID}"

# -------- eval defaults (nice-to-have) --------
export EVAL_PROMPT="${EVAL_PROMPT:-score100_v1}"
export EVAL_PARSER="${EVAL_PARSER:-score100_first}"
export EVAL_BT_TEMP="${EVAL_BT_TEMP:-20}"
export EVAL_UNC_LOW="${EVAL_UNC_LOW:-20}"
export EVAL_UNC_HIGH="${EVAL_UNC_HIGH:-80}"
